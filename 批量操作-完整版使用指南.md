# 🎯 批量操作功能 - 完整版使用指南

## ✅ 功能说明

批量操作功能已完美实现！现在可以**直接拖动**框选多个对象，右侧属性面板会显示所有选中对象的平均属性值，并提供图标化的对齐工具。

## 🚀 使用方法（超简单！）

### 步骤 1: 直接拖动框选
- **直接拖动鼠标**即可框选（不需要按任何键！）
- 会出现蓝色虚线框
- 释放鼠标完成选择

### 步骤 2: 查看和编辑属性
框选完成后，**右侧属性面板**会自动显示：
- 📍 **位置** - 所有对象的平均位置（X, Y, Z）
- 🔄 **旋转** - 所有对象的平均旋转角度
- 📏 **缩放** - 所有对象的平均缩放值
- 🎯 **对齐工具** - 6个图标化对齐按钮
- 🛠️ **操作按钮** - 复制、组合、删除

### 步骤 3: 取消选择
- **点击空白处**即可取消选择
- 或按 **ESC 键**

## 🎨 右侧面板详解

### 📋 标题栏
```
✓✓ 批量操作
已选择 3 个对象
```

### 📍 位置属性
```
位置
├─ 位置 X: -3.89  ← 平均X坐标
├─ 位置 Y:  1.50  ← 平均Y坐标
└─ 位置 Z:  4.18  ← 平均Z坐标
```
- 修改数值会**同时移动**所有对象
- 保持对象之间的相对位置

### 🔄 旋转属性
```
旋转角度
├─ 旋转 X: 0°
├─ 旋转 Y: 0°
└─ 旋转 Z: 0°
```
- 显示平均旋转角度
- 修改会**同时旋转**所有对象

### 📏 缩放属性
```
缩放
├─ X: 4.00
├─ Y: 3.00
└─ Z: 0.20
```
- 显示平均缩放值
- 修改会**按比例缩放**所有对象

### 🎯 对齐工具（图标化）
```
┌─────────────────────────────┐
│ [|] [|] [|] [‾] [|] [_]     │
│  ↑   ↑   ↑   ↑   ↑   ↑      │
│  左  中  右  顶  中  底      │
└─────────────────────────────┘
```

6个对齐按钮：
- **[|]** 左对齐 - 所有对象左边缘对齐
- **[|]** 水平居中 - 所有对象水平居中
- **[|]** 右对齐 - 所有对象右边缘对齐
- **[‾]** 顶部对齐 - 所有对象顶部对齐
- **[|]** 垂直居中 - 所有对象垂直居中
- **[_]** 底部对齐 - 所有对象底部对齐

### 📊 分布工具
```
[水平分布] [垂直分布]
```
- **水平分布** - X轴均匀分布（需≥3个对象）
- **垂直分布** - Z轴均匀分布（需≥3个对象）

### 🛠️ 操作按钮
```
[📋 复制]
[📦 组合]
[🗑️ 删除选中]
```

## 💡 使用技巧

### 快速框选
```
拖动鼠标 → 出现蓝色框 → 释放 → 右侧面板显示
```

### 批量移动
1. 框选多个对象
2. 修改"位置 X"的值
3. 所有对象一起移动

### 对齐示例
1. 框选3个立方体
2. 点击"水平居中"图标按钮
3. 所有立方体水平居中对齐

### 批量缩放
1. 框选多个对象
2. 修改"缩放 X"的值为 2
3. 所有对象X轴放大2倍

## 🎬 实际操作流程

### 示例 1: 对齐墙体
```
1. 拖动鼠标框选多个墙体
2. 右侧面板显示批量操作
3. 点击"左对齐"图标
4. 所有墙体左边缘对齐
```

### 示例 2: 批量调整高度
```
1. 框选多个对象
2. 修改"位置 Y"为 5
3. 所有对象移动到Y=5的高度
```

### 示例 3: 均匀分布设备
```
1. 框选5个设备
2. 点击"水平分布"
3. 设备在X轴上均匀分布
```

## 📝 重要特性

### ✅ 优点
1. **无需按键** - 直接拖动即可框选
2. **点击取消** - 点击空白处取消选择
3. **显示平均值** - 显示所有对象的平均属性
4. **图标化对齐** - 6个直观的对齐图标
5. **实时编辑** - 修改属性立即生效
6. **保持相对位置** - 移动时保持对象间距

### 🎯 核心功能
- ✅ 直接拖动框选（无需 Shift）
- ✅ 点击空白取消选择
- ✅ 显示位置、旋转、缩放平均值
- ✅ 6个图标化对齐按钮
- ✅ 水平/垂直分布
- ✅ 复制、组合、删除

### ⚠️ 注意事项
1. 框选时会出现蓝色虚线框
2. 分布功能需要至少3个对象
3. 修改属性会同时影响所有选中对象
4. 删除操作不可撤销，请谨慎使用

## 🆚 与单个对象编辑的区别

| 特性 | 单个对象 | 批量操作 |
|------|----------|----------|
| 位置显示 | 实际位置 | 平均位置 |
| 修改行为 | 设置绝对值 | 相对偏移 |
| 旋转显示 | 实际角度 | 平均角度 |
| 缩放显示 | 实际缩放 | 平均缩放 |
| 对齐工具 | 无 | 6个图标按钮 |

## 🎨 界面预览

```
┌─────────────────────────────┐
│ ✓✓ 批量操作                  │
│ 已选择 3 个对象               │
├─────────────────────────────┤
│ 位置                         │
│ 位置 X: -3.89               │
│ 位置 Y:  1.50               │
│ 位置 Z:  4.18               │
├─────────────────────────────┤
│ 旋转角度                     │
│ 旋转 X: 0                   │
│ 旋转 Y: 0                   │
│ 旋转 Z: 0                   │
├─────────────────────────────┤
│ 缩放                         │
│ X: 4.00                     │
│ Y: 3.00                     │
│ Z: 0.20                     │
├─────────────────────────────┤
│ 对齐                         │
│ [|] [|] [|] [‾] [|] [_]     │
│ [水平分布] [垂直分布]        │
├─────────────────────────────┤
│ 操作                         │
│ [📋 复制]                    │
│ [📦 组合]                    │
│ [🗑️ 删除选中]               │
└─────────────────────────────┘
```

## 🔧 技术细节

### 平均值计算
```javascript
// 位置平均值
const avgX = batchSelected.reduce((sum, obj) => 
    sum + obj.position.x, 0) / batchSelected.length;

// 旋转平均值（转换为角度）
const avgRotX = Math.round(
    (batchSelected.reduce((sum, obj) => 
        sum + obj.rotation.x, 0) / batchSelected.length
    ) * 180 / Math.PI
);

// 缩放平均值
const avgScaleX = batchSelected.reduce((sum, obj) => 
    sum + obj.scale.x, 0) / batchSelected.length;
```

### 相对偏移
```javascript
// 修改位置时使用偏移量
const avgX = /* 计算平均值 */;
const offset = newValue - avgX;
batchSelected.forEach(obj => obj.position.x += offset);
```

### 对齐算法
```javascript
// 左对齐
const box = new THREE.Box3();
batchSelected.forEach(obj => box.expandByObject(obj));
batchSelected.forEach(obj => {
    const objBox = new THREE.Box3().setFromObject(obj);
    obj.position.x += (box.min.x - objBox.min.x);
});
```

## 💻 开发者信息

### 相关文件
- `src/App.jsx` - 主应用文件（已完整集成）
- `src/components/BoxSelection.jsx` - 框选组件
- `src/hooks/useBatchOperations.js` - 批量操作 Hook

### 核心状态
```javascript
const [batchSelectedObjects, setBatchSelectedObjects] = useState([]);
```

## 🎉 开始使用

现在就试试吧！

1. 在场景中添加几个对象
2. **直接拖动鼠标**框选对象
3. 在右侧面板查看和编辑属性
4. 使用图标化的对齐工具
5. 点击空白处取消选择

## 🐛 常见问题

### Q: 拖动没反应？
**A:** 检查：
- 场景中是否有可选择的对象
- 对象是否可见
- 浏览器控制台是否有错误

### Q: 右侧面板没显示？
**A:** 确认：
- 是否成功框选到对象
- 控制台是否输出 "✅ 框选完成"

### Q: 修改属性没效果？
**A:** 可能原因：
- 对象被锁定
- 对象是 Group 类型
- 查看控制台错误

### Q: 对齐按钮不工作？
**A:** 检查：
- 是否选中了多个对象
- 对象是否有正确的包围盒

## 📚 更多资源

- **完整文档**: `BATCH_OPERATIONS_README.md`
- **集成指南**: `BATCH_OPERATIONS_INTEGRATION.md`

---

**提示**：直接拖动 = 框选多个对象 🎯

**快捷键**：
- 框选：直接拖动鼠标
- 取消：点击空白处或按 ESC

**特色功能**：
- 📍 显示平均位置、旋转、缩放
- 🎯 6个图标化对齐按钮
- 🚫 无需按 Shift 键
- ✨ 点击空白处取消选择

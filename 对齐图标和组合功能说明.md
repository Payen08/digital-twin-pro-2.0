# 🎨 对齐图标和组合功能说明

## ✅ 已完成的修改

### 1. 对齐工具改为图标样式并移到顶部

**位置**: 批量操作面板的最顶部，紧接着"批量操作"标题下方

**样式**:
- 深色背景 `bg-[#0a0a0a]`
- 图标按钮排列成一行
- 悬停时高亮显示蓝色边框
- 支持 PNG 图标和 SVG 后备

**包含的按钮**:
1. 左对齐
2. 居中对齐
3. 右对齐
4. （分隔线）
5. 水平分布
6. 垂直分布

### 2. 图标文件夹位置

**路径**: `/public/icons/align/`

**需要的图标文件**:
```
public/
└── icons/
    └── align/
        ├── align-left.png          (左对齐)
        ├── align-center.png        (居中对齐)
        ├── align-right.png         (右对齐)
        ├── distribute-horizontal.png (水平分布)
        └── distribute-vertical.png   (垂直分布)
```

**图标规格**:
- 尺寸: 20x20 像素（推荐）
- 格式: PNG（支持透明背景）
- 颜色: 白色或浅灰色（#CCCCCC）
- 背景: 透明

### 3. 图标后备机制

如果 PNG 图标文件不存在或加载失败，会自动显示 SVG 图标作为后备。

**实现方式**:
```jsx
<img 
    src="/icons/align/align-left.png" 
    alt="左对齐" 
    className="w-5 h-5" 
    onError={(e) => {
        e.target.style.display = 'none';
        e.target.nextSibling.style.display = 'block';
    }} 
/>
<svg width="20" height="20" style={{display: 'none'}}>
    {/* SVG 后备图标 */}
</svg>
```

### 4. 组合功能修复

**问题**: 原来的组合功能会删除原对象，导致对象消失

**修复方案**: 
- 保留所有子对象
- 为子对象添加 `parentId` 属性
- 保存子对象相对于组中心的偏移位置 `relativePosition`
- 创建 `type: 'group'` 的组对象

**组对象结构**:
```javascript
{
    id: 'group-uuid',
    type: 'group',
    name: '组合_1732512345678',
    position: [avgX, avgY, avgZ],  // 组的中心位置
    rotation: [0, 0, 0],
    scale: [1, 1, 1],
    children: ['obj1-id', 'obj2-id', 'obj3-id'],  // 子对象ID列表
    visible: true,
    locked: false,
    color: '#888888'
}
```

**子对象修改**:
```javascript
{
    ...originalObject,
    parentId: 'group-uuid',  // 指向父组
    relativePosition: [offsetX, offsetY, offsetZ]  // 相对位置
}
```

## 🎨 图标设计建议

### 左对齐图标 (align-left.png)
```
|  □
|  □
|  □
```
三个方块左边缘对齐到一条垂直线

### 居中对齐图标 (align-center.png)
```
  |
 □|□
  |
```
三个方块居中对齐到一条垂直线

### 右对齐图标 (align-right.png)
```
  □  |
  □  |
  □  |
```
三个方块右边缘对齐到一条垂直线

### 水平分布图标 (distribute-horizontal.png)
```
□ ← → □ ← → □
```
三个方块在水平方向均匀分布

### 垂直分布图标 (distribute-vertical.png)
```
□
↕
□
↕
□
```
三个方块在垂直方向均匀分布

## 📐 图标制作工具推荐

1. **Figma** - 在线设计工具
2. **Adobe Illustrator** - 专业矢量图形软件
3. **Inkscape** - 免费开源矢量图形编辑器
4. **Canva** - 简单易用的在线设计工具
5. **Photoshop** - 位图编辑软件

## 🎯 使用方法

### 放置图标
1. 将 PNG 图标文件放入 `/public/icons/align/` 文件夹
2. 确保文件名正确（区分大小写）
3. 刷新页面即可看到图标

### 测试对齐功能
1. 框选多个对象
2. 点击顶部的对齐图标按钮
3. 验证对象是否正确对齐

### 测试组合功能
1. 框选至少2个对象
2. 点击"组合"按钮
3. 验证：
   - 对象仍然可见
   - 创建了一个组对象
   - 可以选中组对象
   - 移动组对象时，子对象一起移动

## 🐛 已修复的问题

### 1. 对齐按钮位置
- ❌ 之前：在底部，文字按钮
- ✅ 现在：在顶部，图标按钮

### 2. 对齐按钮样式
- ❌ 之前：文字按钮，占用空间大
- ✅ 现在：图标按钮，紧凑美观

### 3. 组合功能
- ❌ 之前：删除原对象，导致对象消失
- ✅ 现在：保留原对象，添加父子关系

### 4. 图标加载
- ✅ 支持 PNG 图标
- ✅ PNG 加载失败时自动显示 SVG 后备

## 💡 下一步优化建议

1. **添加解散组合功能** - 将组对象拆分回独立对象
2. **组对象可视化** - 在场景中显示组的边界框
3. **嵌套组合** - 支持组内再创建组
4. **组对象层级面板** - 显示组的树形结构
5. **批量修改组成员** - 添加/移除组成员

## 📝 注意事项

1. 图标文件名必须完全匹配（区分大小写）
2. 图标尺寸建议为 20x20 或 24x24 像素
3. 使用透明背景的 PNG 格式
4. 图标颜色建议使用白色或浅灰色
5. 如果没有图标文件，会自动显示 SVG 后备图标

## 🎉 完成状态

- ✅ 对齐工具移到顶部
- ✅ 改为图标样式
- ✅ 创建图标文件夹
- ✅ 添加图标后备机制
- ✅ 修复组合功能
- ✅ 删除底部重复的对齐部分
- ✅ 添加使用说明

现在你可以：
1. 将图标 PNG 文件放入 `/public/icons/align/` 文件夹
2. 刷新页面查看效果
3. 测试对齐和组合功能

如果没有图标文件，会显示默认的 SVG 图标，功能完全正常！
